<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>شبیه‌ساز ارز دیجیتال - فونیکس</title>
<style>
  body { font-family: Tahoma, sans-serif; background: #f9f9f9; text-align:center; padding: 20px; }
  h1 { color: #333; }
  .box { background: #fff; padding: 20px; margin: 20px auto; border-radius: 10px; width: 300px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  button { padding: 10px 20px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
  
  /* دکمه‌های بالا */
  .top-btn { position: fixed; top: 20px; left: 20px; background: teal; color: white; padding: 10px 20px; border-radius: 8px; z-index: 1000; }
  .invite-btn { position: fixed; top: 70px; left: 20px; background: orange; color: white; padding: 10px 20px; border-radius: 8px; z-index: 1000; }
  .delete-btn { position: fixed; top: 120px; left: 20px; background: red; color: white; padding: 10px 20px; border-radius: 8px; z-index: 1000; }
  .admin-btn { position: fixed; top: 170px; left: 20px; background: purple; color: white; padding: 10px 20px; border-radius: 8px; z-index: 1000; }
  
  .top-btn:hover { background: darkcyan; }
  .invite-btn:hover { background: darkorange; }
  .delete-btn:hover { background: darkred; }
  .admin-btn:hover { background: darkmagenta; }

  /* پنل تاریخچه معاملات */
  #transactionList {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 250px;
    max-height: 80vh;
    overflow-y: auto;
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    padding: 10px;
    text-align: right;
  }
  #transactionList h3 { margin-top: 0; }
  #transactions li { margin-bottom: 5px; font-size: 14px; }
</style>
</head>
<body>

<h1>شبیه‌ساز ارز دیجیتال - فونیکس</h1>
<p>کاربر: <span id="username"></span></p>

<!-- دکمه‌ها -->
<button class="top-btn" onclick="addDailyMoney()">پول می‌خوام</button>
<button class="invite-btn" onclick="enterInviteCode()">کد دعوت</button>
<button class="delete-btn" onclick="deleteAccount()">پاک کردن حساب</button>
<button class="admin-btn" onclick="adminPanel()">مدیریت</button>

<div class="box">
  <div class="crypto-name">فونیکس (Phoenix)</div>
  <p>قیمت: <span id="pricePhoenix">10</span> تومان</p>
  <button onclick="buy()">خرید</button>
  <button onclick="sell()">فروش</button>
  <p>مقدار شما: <span id="cryptoPhoenix">0</span> واحد</p>
</div>

<div class="box">
  <p>پول شما: <span id="money">0</span> تومان</p>
</div>

<!-- پنل تاریخچه معاملات -->
<div id="transactionList">
  <h3>تاریخچه معاملات</h3>
  <ul id="transactions"></ul>
</div>

<script>
// ---------- ثبت نام و نام کاربری ----------
let username = localStorage.getItem('username');
if(username){
  document.getElementById('username').innerText = username;
} else {
  let newUsername = prompt("لطفاً نام کاربری خود را وارد کنید:") || "کاربر ناشناس";
  username = newUsername;
  localStorage.setItem('username', username);
  document.getElementById('username').innerText = username;
}

// ---------- پول و ارز ----------
let money = parseFloat(localStorage.getItem('money')) || 0;
let cryptoPhoenix = parseInt(localStorage.getItem('cryptoPhoenix')) || 0;
let pricePhoenix = parseFloat(localStorage.getItem('pricePhoenix')) || 10;

// ---------- تاریخچه معاملات ----------
let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
function addTransaction(type, amount, price){
  const entry = `${new Date().toLocaleTimeString()} - ${type} ${amount} واحد به قیمت ${price.toFixed(1)}`;
  transactions.push(entry);
  localStorage.setItem('transactions', JSON.stringify(transactions));
  updateTransactionDisplay();
}
function updateTransactionDisplay(){
  const ul = document.getElementById('transactions');
  ul.innerHTML = '';
  transactions.slice(-10).forEach(t => { 
    const li = document.createElement('li');
    li.innerText = t;
    ul.appendChild(li);
  });
}

// ---------- نمایش و ذخیره ----------
function updateDisplay(){
  document.getElementById('money').innerText = money.toFixed(1);
  document.getElementById('cryptoPhoenix').innerText = cryptoPhoenix;
  document.getElementById('pricePhoenix').innerText = pricePhoenix.toFixed(1);
  localStorage.setItem('money', money);
  localStorage.setItem('cryptoPhoenix', cryptoPhoenix);
  localStorage.setItem('pricePhoenix', pricePhoenix);
}

// ---------- تغییر قیمت ----------
setInterval(()=>{
  let changePhoenix = (Math.random()*2-1);
  pricePhoenix = Math.max(1, pricePhoenix + changePhoenix);
  updateDisplay();
}, 3000);

// ---------- خرید و فروش ----------
function buy(){
  if(money >= pricePhoenix){
    cryptoPhoenix += 1;
    money -= pricePhoenix;
    addTransaction('خرید', 1, pricePhoenix);
  } else alert("پول کافی برای خرید فونیکس ندارید!");
  updateDisplay();
}
function sell(){
  if(cryptoPhoenix >= 1){
    cryptoPhoenix -= 1;
    money += pricePhoenix;
    addTransaction('فروش', 1, pricePhoenix);
  } else alert("هیچ فونیکسی برای فروش ندارید!");
  updateDisplay();
}

// ---------- پول روزانه ----------
function addDailyMoney(){
  const today = new Date().toDateString();
  const lastClaim = localStorage.getItem('lastClaim') || "";
  if(lastClaim === today){
    alert("امروز قبلاً پول خود را دریافت کرده‌اید. دوباره فردا تلاش کنید!");
  } else {
    money += 10;
    localStorage.setItem('lastClaim', today);
    updateDisplay();
    alert("10 تومان روزانه به حساب شما اضافه شد!");
  }
}

// ---------- کد دعوت ----------
function enterInviteCode(){
  const usedInvite1 = JSON.parse(localStorage.getItem('usedInvite1')) || false;
  const usedInvite2 = JSON.parse(localStorage.getItem('usedInvite2')) || false;
  const code = prompt("لطفاً کد دعوت را وارد کنید:");
  if(!code) return;

  if(code === "FONIKS100"){
    if(usedInvite1) alert("کد FONIKS100 فقط یکبار قابل استفاده است!");
    else { money += 100; localStorage.setItem('money', money); localStorage.setItem('usedInvite1', true); updateDisplay(); alert("100 تومان اضافه شد."); }
  } else if(code === "FONGOL"){
    if(usedInvite2) alert("کد FONGOL فقط یکبار قابل استفاده است!");
    else { money += 10; localStorage.setItem('money', money); localStorage.setItem('usedInvite2', true); updateDisplay(); alert("10 تومان اضافه شد."); }
  } else alert("کد اشتباه است!");
}

// ---------- پاک کردن حساب ----------
function deleteAccount(){
  if(confirm("آیا مطمئن هستید؟")){
    localStorage.clear();
    alert("حساب شما پاک شد!");
    location.reload();
  }
}

// ---------- پنل مدیریت ----------
function adminPanel(){
  const password = prompt("رمز مدیریت را وارد کنید:");
  if(password !== "10ADMINO"){ alert("رمز اشتباه است!"); return; }

  const targetUser = prompt("نام کاربری موردنظر برای ویرایش پول را وارد کنید:");
  if(!targetUser) return;

  const amount = parseFloat(prompt("مقدار پولی که می‌خواید اضافه کنید:"));
  if(isNaN(amount)){ alert("مقدار نامعتبر!"); return; }

  // اضافه کردن پول به کاربر
  const key = targetUser === username ? "money" : `money_${targetUser}`;
  let current = parseFloat(localStorage.getItem(key)) || 0;
  current += amount;
  localStorage.setItem(key, current);

  alert(`به کاربر ${targetUser}، ${amount} تومان اضافه شد!`);
  if(targetUser === username) { money = current; updateDisplay(); }
}

updateDisplay();
updateTransactionDisplay();
</script>

</body>
</html>
